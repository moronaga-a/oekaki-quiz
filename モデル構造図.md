# モデル構造図 - お絵描きクイズゲーム

Railsアプリのモデル層（状態管理）の構造と関係性を図解

---

## 全体構造図

```mermaid
flowchart TD
    RoomStore[🏢 RoomStore Singleton<br/>アプリ全体で1つ]

    Room1[🏠 Room ABC123<br/>id: ABC123<br/>host_id: p_001]
    Room2[🏠 Room XYZ789]

    PlayerA[👤 Player A<br/>id: p_001<br/>name: A<br/>role: drawer]
    PlayerB[👤 Player B<br/>id: p_002<br/>name: B<br/>role: guesser]
    PlayerC[👤 Player C<br/>id: p_003<br/>name: C<br/>role: guesser]

    GameState[🎮 GameState<br/>status: playing<br/>current_topic: りんご<br/>drawer_id: p_001]

    RoomStore -->|管理| Room1
    RoomStore -->|管理| Room2

    Room1 -->|1対多| PlayerA
    Room1 -->|1対多| PlayerB
    Room1 -->|1対多| PlayerC

    Room1 -->|1対1| GameState

    style RoomStore fill:#FFE4B5
    style Room1 fill:#E0FFE0
    style Room2 fill:#E0FFE0
    style GameState fill:#FFB6C1
    style PlayerA fill:#87CEEB
    style PlayerB fill:#87CEEB
    style PlayerC fill:#87CEEB
```

---

## 1. RoomStore（ルーム管理）

### 役割
- アプリ全体でルームを一元管理
- シングルトンパターン（1つのインスタンスのみ）

---

## 2. Room（個別ルーム）

### 役割
- プレイヤーを管理
- ゲーム状態を保持
- ホスト管理

---

## 3. Player（プレイヤー）

### 役割
- プレイヤー情報を保持
- 役割（お絵描き/回答）を管理

---

## 4. GameState（ゲーム状態）

### 役割
- ゲームの進行状態を管理
- お題とお絵描き役を保持
- ステートマシンパターン

```

## まとめ

### モデル構造の階層

```
RoomStore (Singleton)
  └── Room (複数)
       ├── Player (複数)
       └── GameState (1つ)
```

### 関係性

- RoomStore -(1対多)→ Room: 全ルームを管理
- Room -(1対多)→ Player: ルーム内のプレイヤーを管理
- Room -(1対1)→ GameState: ゲーム状態を保持
